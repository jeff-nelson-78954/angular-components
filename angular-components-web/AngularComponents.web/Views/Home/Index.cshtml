@{
    ViewBag.Title = "Home Page";
}

<style>
@@font-face {
    font-family: 'fcicons';
    src: url("data:application/x-font-ttf;charset=utf-8;base64,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") format("truetype");
    font-weight: normal;
    font-style: normal; }
</style>
<div class="row highlight mt-30">
    <h3>Parent component communication</h3>
    <div class="col-md-4">
        <h4>Voting microfront end</h4>
        <ul>
            <li>Input: userName</li>
            <li>Output: userVoted <span id="voteEvent" style="font-weight:bold"></span></li>
            <li>Listens for: user-poll-vote <input type="button" value="Vote Yes" id="btnVoteYes" class="btn btn-primary" /></li>
        </ul>
    </div>
    <div class="col-md-8">
        <h4>Calendar microfront end</h4>
        <ul>
            <li>Input: calendarName</li>
            <li>Output: eventAdded <span id="eventAdded" style="font-weight:bold"></span></li>
            <li>
                Listens for: appointment-calendar-add-event
                <input type="text" id="txtTitle" placeholder="Title" />
                <input type="date" id="txtDate" placeholder="Date" />
                <input type="button" value="Add" id="btnAddEvent" class="btn btn-primary" />
            </li>
            <li>Listens for: appointment-calendar-set-events <input type="button" value="Clear Events" id="btnClearEvents" class="btn btn-primary" /></li>
        </ul>
    </div>
</div>

<div class="row mt-30">
    <div class="col-md-4">
        <user-poll user-name="Jeff"></user-poll>
    </div>
    <div class="col-md-8">
        <event-listener></event-listener>
    </div>
</div>
<div class="row mt-10">
    <div class="col">        
        <appointment-calendar calendar-name="Appointment Calendar"></appointment-calendar>
    </div>
</div>

@section Scripts {
    <script src="~/node_modules/jnelson-ae-user-poll/main-es2015.js" type="module"></script>
    <script src="~/node_modules/jnelson-ae-user-poll/main-es5.js" nomodule></script>
    <script src="~/node_modules/jnelson-ae-appointment-calendar/main-es2015.js" type="module"></script>
    <script src="~/node_modules/jnelson-ae-appointment-calendar/main-es5.js" nomodule></script>
    <script src="~/node_modules/jnelson-ae-event-listener/main-es2015.js" type="module"></script>
    <script src="~/node_modules/jnelson-ae-event-listener/main-es5.js" nomodule></script>

    <script>
        $(function () {
            // the angular element has @@Output() userVoted that this hooks into.
            // proves this window can listed for events
            $('user-poll').on('userVoted', function (event) {
                $('#voteEvent').html('(' + event.detail + ')');
            });
            // Angular element is listing for a message. Triggers an event.
            $('#btnVoteYes').click(() => {
                const message = { type: 'user-poll-vote', data: 'yes' };
                window.postMessage(message);
            });

            $('appointment-calendar').on('eventAdded', function (event) {
                $('#eventAdded').html('(' + JSON.stringify(event.detail) + ')');
            });

            $('#btnAddEvent').click(() => {
                if ($('#txtTitle').val() && $('#txtDate').val()) {
                    const message = { type: 'appointment-calendar-add-event', data: { title: $('#txtTitle').val(), date: $('#txtDate').val() } };
                    window.postMessage(message);
                    $('#txtTitle').val('');
                    $('#txtDate').val('');
                }                
            });

            $('#btnClearEvents').click(() => {
                const message = { type: 'appointment-calendar-set-events', data: [] };
                window.postMessage(message);
            });
        });
    </script>
}